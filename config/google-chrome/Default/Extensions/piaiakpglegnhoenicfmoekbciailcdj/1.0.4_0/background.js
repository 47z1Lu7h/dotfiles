(()=>{var e={815:function(e,t){var r,n,a;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,n=[e],r=function(e){"use strict";if("object"!=typeof globalThis||"object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const t="The message port closed before a response was received.",r=e=>{const r={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(r).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class n extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const a=e=>e&&"object"==typeof e&&"function"==typeof e.then,i=(t,r)=>(...n)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):r.singleCallbackArg||n.length<=1&&!1!==r.singleCallbackArg?t.resolve(n[0]):t.resolve(n)},o=e=>1==e?"argument":"arguments",s=(e,t)=>function(r,...n){if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((a,o)=>{if(t.fallbackToNoCallback)try{r[e](...n,i({resolve:a,reject:o},t))}catch(i){r[e](...n),t.fallbackToNoCallback=!1,t.noCallback=!0,a()}else t.noCallback?(r[e](...n),a()):r[e](...n,i({resolve:a,reject:o},t))}))},c=(e,t,r)=>new Proxy(t,{apply:(t,n,a)=>r.call(n,e,...a)});let u=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},r={})=>{let n=Object.create(null),a={has:(t,r)=>r in e||r in n,get(a,i,o){if(i in n)return n[i];if(!(i in e))return;let p=e[i];if("function"==typeof p)if("function"==typeof t[i])p=c(e,e[i],t[i]);else if(u(r,i)){let t=s(i,r[i]);p=c(e,e[i],t)}else p=p.bind(e);else if("object"==typeof p&&null!==p&&(u(t,i)||u(r,i)))p=l(p,t[i],r[i]);else{if(!u(r,"*"))return Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:()=>e[i],set(t){e[i]=t}}),p;p=l(p,t[i],r["*"])}return n[i]=p,p},set:(t,r,a,i)=>(r in n?n[r]=a:e[r]=a,!0),defineProperty:(e,t,r)=>Reflect.defineProperty(n,t,r),deleteProperty:(e,t)=>Reflect.deleteProperty(n,t)},i=Object.create(e);return new Proxy(i,a)},p=e=>({addListener(t,r,...n){t.addListener(e.get(r),...n)},hasListener:(t,r)=>t.hasListener(e.get(r)),removeListener(t,r){t.removeListener(e.get(r))}}),g=new n((e=>"function"!=typeof e?e:function(t){const r=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(r)}));let m=!1;const f=new n((e=>"function"!=typeof e?e:function(t,r,n){let i,o,s=!1,c=new Promise((e=>{i=function(t){m||(m=!0),s=!0,e(t)}}));try{o=e(t,r,i)}catch(e){o=Promise.reject(e)}const u=!0!==o&&a(o);if(!0!==o&&!u&&!s)return!1;const l=e=>{e.then((e=>{n(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",n({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{}))};return l(u?o:c),!0})),d=({reject:r,resolve:n},a)=>{e.runtime.lastError?e.runtime.lastError.message===t?n():r(new Error(e.runtime.lastError.message)):a&&a.__mozWebExtensionPolyfillReject__?r(new Error(a.message)):n(a)},h=(e,t,r,...n)=>{if(n.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${o(t.minArgs)} for ${e}(), got ${n.length}`);if(n.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${o(t.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((e,t)=>{const a=d.bind(null,{resolve:e,reject:t});n.push(a),r.sendMessage(...n)}))},y={devtools:{network:{onRequestFinished:p(g)}},runtime:{onMessage:p(f),onMessageExternal:p(f),sendMessage:h.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:h.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},v={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return r.privacy={network:{"*":v},services:{"*":v},websites:{"*":v}},l(e,y,r)};e.exports=r(chrome)}else e.exports=globalThis.browser},void 0===(a="function"==typeof r?r.apply(t,n):r)||(e.exports=a)}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=r(815),t=r.n(e);function n(e,t,r){return t=p(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,a()?Reflect.construct(t,r||[],p(e).constructor):t.apply(e,r))}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(a=function(){return!!e})()}function i(){i=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,o=Object.create(i.prototype),s=new T(n||[]);return a(o,"_invoke",{value:E(e,r,s)}),o}function g(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var m="suspendedStart",f="suspendedYield",d="executing",h="completed",y={};function v(){}function A(){}function x(){}var w={};l(w,s,(function(){return this}));var b=Object.getPrototypeOf,_=b&&b(b(j([])));_&&_!==r&&n.call(_,s)&&(w=_);var k=x.prototype=v.prototype=Object.create(w);function O(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(a,i,o,s){var c=g(e[a],e,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(l).then((function(e){u.value=e,o(u)}),(function(e){return r("throw",e,o,s)}))}s(c.arg)}var i;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return i=i?i.then(a,a):a()}})}function E(t,r,n){var a=m;return function(i,o){if(a===d)throw Error("Generator is already running");if(a===h){if("throw"===i)throw o;return{value:e,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var c=I(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===m)throw a=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=d;var u=g(t,r,n);if("normal"===u.type){if(a=n.done?h:f,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=h,n.method="throw",n.arg=u.arg)}}}function I(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=g(a,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var o=i.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function j(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return A.prototype=x,a(k,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:A,configurable:!0}),A.displayName=l(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===A||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,l(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},O(P.prototype),l(P.prototype,c,(function(){return this})),t.AsyncIterator=P,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var o=new P(p(e,r,n,a),i);return t.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},O(k),l(k,u,"Generator"),l(k,s,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;L(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:j(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function o(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){c(i,n,a,o,s,"next",e)}function s(e){c(i,n,a,o,s,"throw",e)}o(void 0)}))}}function l(e,t,r){return(t=o(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function m(e){var t="function"==typeof Map?new Map:void 0;return m=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(a())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&g(i,r.prototype),i}(e,arguments,p(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),g(r,e)},m(e)}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}var h=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=n(this,t,[e])).name="kodepay error",r.message=e,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(t,m(Error)),r=t,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}();l(h,"CONTENT_SCRIPT_NOT_LOADED","content script set up error: Please configure your manifest.json strictly according to the content script configuration in document_start"),l(h,"CREATE_API_KEY_ERROR","create uuid key error: please check the extension id"),l(h,"NO_STORAGE_PERMISSION","no storage in permissions, please add storage in permissions in manifest.json"),l(h,"GET_USER_INFO_ERROR","get user info error: please check your extension key and extension id, Finally, you can contact the developer for support"),l(h,"NO_ACCESS_KEY","no access key, please check your extension key and extension id, Finally, you can contact the developer for support"),l(h,"MODE_KEY_ERROR","mode must be development or production"),l(h,"LIMIT_ERROR","request too fast, please try again later");let y=!1;function v(){A.get_user_info().then((e=>{var t=3;if(1e5===e.code){const r=function(e){if(Array.isArray(e)&&e.length>0){let t=["created","updated"],r=["canceling","canceled"];return e.filter((e=>{if("one_time"===e.plan_type&&"succeed"===e.pay_status)return e;if("recurring"===e.plan_type){if(t.includes(e.order_status))return e;if(r.includes(e.order_status)&&e.plan_end>Date.now()/1e3)return e}}))}}(e.payinfo);null!=r&&r.length>0&&(t=-1)}chrome.storage.local.set({tg_li:t},(()=>{}))}))}chrome.runtime.onMessage.addListener(((e,t,r)=>("popupopen"===e.type?(y=e.status,r({status:"success"})):"down"===e.type?chrome.storage.local.get("dcount",(function(e){if(e&&e.dcount&&e.dcount>0){var t=e.dcount+1;chrome.storage.local.set({dcount:t},(()=>{r({status:t})}))}else chrome.storage.local.set({dcount:1},(()=>{r({status:1})}))})):"getc"===e.type?chrome.storage.local.get("dcount",(function(e){e&&e.dcount&&e.dcount>0?r({status:e.dcount}):r({status:0})})):"getl"===e.type&&chrome.storage.local.get("tg_li",(function(e){r({status:e.tg_li})})),!0)));const A=function(e){var r,n=e.application_id,a=e.client_id,o=e.mode,c=void 0===o?"production":o,l="https://api.kodepay.io";if("development"===c)r=l+"/sandbox";else{if("production"!==c)throw new h(h.MODE_KEY_ERROR);r=l}var p=function(){try{return navigator.language}catch(e){return""}}(),g=function(){try{return t().runtime.id}catch(e){return""}}(),m=1e5,f="2.1.4",y="".concat(r,"/api/extension/new-key"),v="".concat(r,"/api/extension/user-managerment"),A="".concat(r,"/api/extension/user-info"),x="".concat(r,"/api/extension/search-order"),w="".concat(r,"/api/extension/make-order"),b="".concat(r,"/api/extension/client-user-login"),_="".concat(r,"/api/extension/loginpage"),k=a+"_user",O=a+"_ext_key",P="".concat(r,"/api/extension/pre_make_order"),E="2.0.1",I=[],S=[],L="",T={},j={last_access_time:0,limit:5e3},N={last_access_time:0,limit:5e3},C={last_access_time:0,limit:5e3},R={last_access_time:0,limit:5e3};function M(){return F.apply(this,arguments)}function F(){return(F=u(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(_,{method:"POST"});case 2:if(t=e.sent,parseInt(t.code)!==m){e.next=7;break}return e.abrupt("return",{url:t.data.url,api_status:"succeed"});case 7:if(401!==parseInt(t.code)){e.next=11;break}return e.abrupt("return",{url:t.data.url,api_status:"expired"});case 11:throw new h("Retrieves the login page URL Error:"+JSON.stringify(t));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t,r){return D.apply(this,arguments)}function D(){return D=u(i().mark((function e(t,r,o){var s,u,l,m=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=m.length>3&&void 0!==m[3]?m[3]:"error",e.prev=1,e.t0=s,e.t1=t,e.t2=c,e.t3=n,e.t4=a,e.next=9,te(O);case 9:e.t5=e.sent,e.t6=E,e.t7=g,e.t8=p,e.t9=r,e.t10=JSON.stringify(o),e.t11=Math.floor((new Date).getTime()/1e3),e.t12=(new Date).toLocaleString(),u={level:e.t0,message:e.t1,env:e.t2,application_id:e.t3,client_id:e.t4,api_key:e.t5,app_version:e.t6,store_id:e.t7,language:e.t8,func_name:e.t9,params:e.t10,unix_timestamp:e.t11,local_time:e.t12},l="&"+Object.keys(u).map((function(e){return"".concat(e,"=").concat(encodeURIComponent(u[e]))})).join("&"),fetch("https://kodepay-us.us-west-1.log.aliyuncs.com/logstores/kodepay-frontend/track?APIVersion=0.6.0"+l,{method:"GET"}).then().then().catch((function(e){})),e.next=26;break;case 23:e.prev=23,e.t13=e.catch(1);case 26:case"end":return e.stop()}}),e,null,[[1,23]])}))),D.apply(this,arguments)}function G(e){return J.apply(this,arguments)}function J(){return J=u(i().mark((function e(t){var r,n,a,o,s,c=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>2&&void 0!==c[2]?c[2]:null,a={price_id:t},(r=c.length>1&&void 0!==c[1]?c[1]:"")&&(a.redirect_url=r),!n){e.next=10;break}if(!B(n)){e.next=9;break}a.origin_data=n,e.next=10;break;case 9:throw new h("origial_data is not a JSON object");case 10:return e.next=12,K(w,{method:"POST",body:JSON.stringify(a)});case 12:if(o=e.sent,parseInt(o.code)!==m){e.next=17;break}return e.abrupt("return",{data:o.data,api_status:"succeed"});case 17:if(401!==parseInt(o.code)){e.next=21;break}return e.abrupt("return",{data:o.data,api_status:"expired"});case 21:throw s="get payment url error: ".concat(JSON.stringify(o)),o.code&&o.message&&(s="".concat(o.code,": ").concat(o.message)),new h(s);case 24:case"end":return e.stop()}}),e)}))),J.apply(this,arguments)}function $(e){return q.apply(this,arguments)}function q(){return q=u(i().mark((function e(t){var r,n,a,o,s,c=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>2&&void 0!==c[2]?c[2]:null,a={price_id:t,payment_method:c.length>3?c[3]:void 0,payment_channel:c.length>4?c[4]:void 0,currency:c.length>5?c[5]:void 0},(r=c.length>1&&void 0!==c[1]?c[1]:"")&&(a.redirect_url=r),!n){e.next=13;break}if(!B(n)){e.next=12;break}a.origin_data=n,e.next=13;break;case 12:throw new h("origial_data is not a JSON object");case 13:return e.next=15,K(w,{method:"POST",body:JSON.stringify(a)});case 15:if(o=e.sent,parseInt(o.code)!==m){e.next=20;break}return e.abrupt("return",{data:o.data,api_status:"succeed"});case 20:if(401!==parseInt(o.code)){e.next=24;break}return e.abrupt("return",{data:o.data,api_status:"expired"});case 24:throw s="get payment url error: ".concat(JSON.stringify(o)),o.code&&o.message&&(s="".concat(o.code,": ").concat(o.message)),new h(s);case 27:case"end":return e.stop()}}),e)}))),q.apply(this,arguments)}function B(e){return"object"===s(e)&&null!==e&&!Array.isArray(e)}function K(e){return Y.apply(this,arguments)}function Y(){return Y=u(i().mark((function e(t){var r,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=3,te(O);case 3:if((L=e.sent)||t===y){e.next=8;break}return e.next=7,H();case 7:L=e.sent;case 8:return r.headers=Z(r),e.abrupt("return",fetch(t,r).then((function(e){return W(e),e.json()})).then((function(e){return 100120===parseInt(e.code)?z(t,r):e})).catch((function(e){throw U("Network request failed: ".concat(e.name," ").concat(e.message),"seaFetch",{url:t,options:Object.values(r)}).then().catch(),new h("Network request failed: ".concat(e.name," ").concat(e.message))})));case 10:case"end":return e.stop()}}),e)}))),Y.apply(this,arguments)}function W(e){var t=e.headers;if(t.has("set-api-key")){var r=t.get("set-api-key");r&&X(O,L=r).then()}}function z(e,t){return V.apply(this,arguments)}function V(){return(V=u(i().mark((function e(t,r){var n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H();case 3:return n=e.sent,r.headers.set("api-key",n),e.next=7,fetch(t,r);case 7:return a=e.sent,e.next=10,a.json();case 10:return e.abrupt("return",e.sent);case 13:e.prev=13,e.t0=e.catch(0),U("Rotating API key failed: ".concat(e.t0.name,", ").concat(e.t0.message),"rotatingApiKey",{url:t,options:r}).then().catch();case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function Z(e){var t=new Headers(e.headers||{});return t.append("content-type","application/json"),t.append("application-id",n||""),t.append("language",p||""),t.append("npm-version",f),t.append("plugin-id",g||""),t.append("client-id",a||""),t.append("api-key",L||""),t.append("app-version",E),t}function H(){return Q.apply(this,arguments)}function Q(){return(Q=u(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K(y,{method:"POST"});case 3:if(t=e.sent,parseInt(t.code)!==m){e.next=9;break}return r=t.data["api-key"],e.next=8,X(O,r);case 8:return e.abrupt("return",r);case 9:throw new h("".concat(JSON.stringify(t)));case 12:throw e.prev=12,e.t0=e.catch(0),U("Failed to create API key: ".concat(e.t0.message),"create_extension_key",{}).then().catch(),new h("Failed to create API key: ".concat(e.t0.name," ").concat(e.t0.message));case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function X(e,t){return ee.apply(this,arguments)}function ee(){return(ee=u(i().mark((function e(r,n){var a,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a={})[r]=n,e.prev=2,e.next=5,t().storage.local.set(a);case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),U("Failed to write localstorage:"+(o="".concat(e.t0.name,":").concat(e.t0.message)),"set_local_storage",{k:r,value:n}).then().catch(),h("Failed to set local storage:"+o);case 13:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function te(e){return re.apply(this,arguments)}function re(){return(re=u(i().mark((function e(r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t().storage.local.get(r);case 3:return n=e.sent,e.abrupt("return",n[r]);case 7:e.prev=7,e.t0=e.catch(0),U("get local storage error:".concat(e.t0.name," ").concat(e.t0.message),"get_local_storage",{k:r}).then().catch();case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function ne(){return(ne=u(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",ae());case 4:e.prev=4,e.t0=e.catch(0),U("Error in getUserInfo API: "+e.t0.message,"get_user_info",{}).then().catch();case 7:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}function ae(){return ie.apply(this,arguments)}function ie(){return(ie=u(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(A,{method:"POST"});case 2:return t=e.sent,e.next=5,X(k,t);case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(){return se.apply(this,arguments)}function se(){return se=u(i().mark((function e(){var t,r=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.prev=1,e.abrupt("return",ae());case 5:e.prev=5,e.t0=e.catch(1),U("Error in getUserInfo API: "+e.t0.message,"getUserInfo",t).then().catch();case 8:case"end":return e.stop()}}),e,null,[[1,5]])}))),se.apply(this,arguments)}function ce(e){return null==e||""===e||!(!Array.isArray(e)||0!==e.length)||"object"===s(e)&&0===Object.keys(e).length||"number"==typeof e&&isNaN(e)}!function(){if(ce(n)||ce(a))throw new h(h.NO_ACCESS_KEY);try{if(t().runtime.getManifest().permissions.includes("storage"))return!0}catch(e){throw new h(h.NO_STORAGE_PERMISSION)}throw new h(h.NO_STORAGE_PERMISSION)}(),t().runtime.onMessage.addListener((function(e){try{if(e.data&&e.type)if("pay"===e.type&&e.data.transaction_key){var t=e.data.transaction_key;T[t]?0===parseInt(e.data.status)?(T[t].status="failed",T[t].Interval&&clearInterval(T[t].Interval)):1===parseInt(e.data.status)&&"uncompleted"===T[t].status&&(T[t].Interval&&clearInterval(T[t].Interval),ge(t).then().catch((function(r){U("pay succeed polling error:".concat(r.name,",").concat(r.message),"checkOrderStatus",{event:e,transaction_id:t,orders:T}).then().catch()})),T[t].Interval=fe({transaction_id:t,max_retries:6,retry_interval:3e3,timeout:2e4})):ke(t)}else if(L===e.data.api_key&&n===e.data.application_id&&a===e.data.client_id)if("login"===e.type)(function(){return de.apply(this,arguments)})().then().catch((function(e){U("login succeed polling error:".concat(e.name,",").concat(e.message),"startLoginPolling",{}).then().catch()}));else if("transaction"===e.type&&a===e.data.client_id){if(T[e.data.transaction_id]&&"uncompleted"===T[e.data.transaction_id].status)return;ke(e.data.transaction_id)}}catch(t){U("start callback listener error:".concat(t.name,",").concat(t.message),"startCallBackListener",{event:e,orders:T}).then().catch()}}));var ue=[];function le(e,t,r){return pe.apply(this,arguments)}function pe(){return(pe=u(i().mark((function e(r,n,a){var o,s,c,u,l,p,g,m,f;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t()&&t().windows&&t().windows.create,s=!1,e.prev=2,c=!1,!o){e.next=28;break}if(!ue.some((function(e){return e.url===r}))){e.next=14;break}return u=ue.find((function(e){return e.url===r})),e.next=10,t().windows.update(u.id,{focused:!0});case 10:c=!0,e.next=26;break;case 14:return e.next=16,t().windows.getCurrent();case 16:return l=e.sent,p=Math.round((l.width-n)/2+l.left),g=Math.round((l.height-a)/2+l.top),m={url:r,left:parseInt(p),top:parseInt(g),type:"popup",width:n,height:a},e.next=23,t().windows.create(m);case 23:f=e.sent,ue.push({id:f.id,url:r}),c=!0;case 26:e.next=31;break;case 28:window.open(r,"popup","scrollbars=no,resizable=yes,status=no,location=no,toolbar=no,menubar=no,titlebar=no,dependent=yes,width=".concat(n,",height=").concat(a))&&(ue.push({id:null,url:r}),c=!0),U("Failed to open window:","openSeaWebPage",{width:n,height:a,is_support_windows_create:!!o,is_window_update:s}).then().catch();case 31:return e.abrupt("return",c);case 34:return e.prev=34,e.t0=e.catch(2),U("Error open window:"+e.t0.message,"openSeaWebPage",{width:n,height:a,is_support_windows_create:!!o,is_window_update:s}).then().catch(),e.abrupt("return",!1);case 39:case"end":return e.stop()}}),e,null,[[2,34]])})))).apply(this,arguments)}function ge(e){return me.apply(this,arguments)}function me(){return(me=u(i().mark((function e(t){var r,n,a,o,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!T[t]||!T[t].status){e.next=22;break}if("uncompleted"!==T[t].status){e.next=18;break}return e.next=4,K(x,{body:JSON.stringify({transaction_id:t}),method:"POST"});case 4:if(r=e.sent,n=parseInt(r.code),a=r.data,n!==m||a.transaction_id!==t){e.next=16;break}if("succeed"!==(o=a.pay_status)&&"failed"!==o){e.next=16;break}return T[t].Interval&&(clearInterval(T[t].Interval),delete T[t]),e.next=13,oe();case 13:s=e.sent,(I=[I[I.length-1]]).forEach((function(e){e(s,o)}));case 16:e.next=20;break;case 18:T[t].Interval&&clearInterval(T[t].Interval),delete T[t];case 20:e.next=24;break;case 22:T[t]&&T[t].Interval&&clearInterval(T[t].Interval),delete T[t];case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.transaction_id,r=void 0===t?"":t,n=e.max_retries,a=void 0===n?6:n,o=e.retry_interval,s=void 0===o?5e3:o,c=e.timeout,l=void 0===c?2e4:c,p=0,g=Date.now(),m=setInterval(u(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ge(r);case 2:Date.now()-g>=l&&(a<10&&U("quick polling timed out","checkOrderStatusPolling",e).then().catch(),clearInterval(m)),++p>a&&(a<10&&U("quick polling timed out","checkOrderStatusPolling",e).then().catch(),clearInterval(m));case 6:case"end":return t.stop()}}),t)}))),s);return m}function de(){return(de=u(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0,t=Date.now(),r=!1,n=setInterval(u(i().mark((function e(){var a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Date.now()-t>36e4)){e.next=4;break}return clearInterval(n),e.abrupt("return");case 4:return e.prev=4,e.next=7,oe();case 7:a=e.sent,!r&&a&&parseInt(a.code)===m&&(clearInterval(n),r=!0,(S=[S[S.length-1]]).forEach((function(e){e(a)}))),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(4);case 16:return e.next=18,new Promise((function(e){return setTimeout(e,5e3)}));case 18:case"end":return e.stop()}}),e,null,[[4,11]])}))),5e3);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(){try{var e,r=d(t().runtime.getManifest().content_scripts);try{for(r.s();!(e=r.n()).done;)if(e.value.matches.find((function(e){if(e.includes("".concat("https://kodepay.io","/*"))||e.includes("<all_urls>")||e.includes("https://*"))return!0})))return}catch(e){r.e(e)}finally{r.f()}}catch(e){}}function ye(){return ye=u(i().mark((function e(t){var r,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={plan_id:t,redirect_url:n.length>1&&void 0!==n[1]?n[1]:"",origial_data:n.length>2&&void 0!==n[2]?n[2]:null,width:n.length>3&&void 0!==n[3]?n[3]:1100,height:n.length>4&&void 0!==n[4]?n[4]:700},e.prev=5,e.abrupt("return",xe(r));case 9:return e.prev=9,e.t0=e.catch(5),U("Error opening the payment page:".concat(e.t0.name," ").concat(e.t0.message),"open_payment_page",r).then(),e.abrupt("return","failed");case 14:case"end":return e.stop()}}),e,null,[[5,9]])}))),ye.apply(this,arguments)}function ve(){return(ve=u(i().mark((function e(t){var r,n,a,o,s,c,u,l,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.plan_id,n=t.redirect_url,a=void 0===n?"":n,o=t.origial_data,s=void 0===o?null:o,c=t.width,u=void 0===c?1100:c,l=t.height,p=void 0===l?700:l,e.prev=1,e.abrupt("return",xe({plan_id:r,redirect_url:a,origial_data:s,width:u,height:p}));case 5:return e.prev=5,e.t0=e.catch(1),U("Error opening the payment page:".concat(e.t0.name," ").concat(e.t0.message),"openPaymentPage",{plan_id:r,redirect_url:a,origial_data:s,width:u,height:p}).then().catch(),e.abrupt("return","failed");case 10:case"end":return e.stop()}}),e,null,[[1,5]])})))).apply(this,arguments)}function Ae(){return(Ae=u(i().mark((function e(t){var r,n,a,o,s,c,u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.plan_id,n=t.redirect_url,a=void 0===n?"":n,o=t.origial_data,s=void 0===o?null:o,c=t.payment_method,u=t.payment_channel,l=t.currency,e.prev=1,e.abrupt("return",be({plan_id:r,redirect_url:a,origial_data:s,payment_method:c,payment_channel:u,currency:l}));case 5:return e.prev=5,e.t0=e.catch(1),U("Error opening the payment page:".concat(e.t0.name," ").concat(e.t0.message),"openPaymentPage",{plan_id:r,redirect_url:a,origial_data:s,width,height}).then().catch(),e.abrupt("return","failed");case 10:case"end":return e.stop()}}),e,null,[[1,5]])})))).apply(this,arguments)}function xe(e){return we.apply(this,arguments)}function we(){return(we=u(i().mark((function e(t){var r,n,a,o,s,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.plan_id,n=t.redirect_url,a=t.origial_data,o=t.width,s=t.height,Oe(C),Je(t,{plan_id:!0}),e.next=5,G(r,n,a);case 5:return c=e.sent,e.next=8,le(c.data.url,o,s);case 8:if(u=e.sent,"succeed"!==c.api_status){e.next=20;break}if(!u){e.next=19;break}if(!c.data.transaction_id){e.next=15;break}ke(c.data.transaction_id),e.next=16;break;case 15:throw new h("The server did not return a transaction_id. Response: ".concat(JSON.stringify(data)));case 16:return e.abrupt("return","succeed");case 19:case 20:return e.abrupt("return","failed");case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){return _e.apply(this,arguments)}function _e(){return(_e=u(i().mark((function e(t){var r,n,a,o,s,c,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.plan_id,n=t.redirect_url,a=t.origial_data,o=t.payment_method,s=t.payment_channel,c=t.currency,Oe(C),Je(t,{plan_id:!0}),e.next=5,$(r,n,a,o,s,c);case 5:if("succeed"!==(u=e.sent).api_status){e.next=8;break}return e.abrupt("return",{code:"succeed",url:u.data.url});case 8:return e.abrupt("return",{code:"failed"});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e){T[e]&&"uncompleted"===T[e].status||(T[e]={status:"uncompleted",Interval:fe({transaction_id:e,max_retries:24,retry_interval:9e3,timeout:18e4,retries:0,start_time:Date.now()})})}function Oe(e){var t=Date.now();if(t-e.last_access_time<e.limit)throw new h(h.LIMIT_ERROR);e.last_access_time=t}function Pe(){return Pe=u(i().mark((function e(){var t,r,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1100,r=n.length>1&&void 0!==n[1]?n[1]:700,e.prev=2,e.abrupt("return",Ie({width:t,height:r}));case 6:return e.prev=6,e.t0=e.catch(2),U("Error opening user management page: ".concat(e.t0.name," ").concat(e.t0.message),"open_user_management_page",{width:t,height:r},"error").then((function(e){})),e.abrupt("return","failed");case 11:case"end":return e.stop()}}),e,null,[[2,6]])}))),Pe.apply(this,arguments)}function Ee(){return Ee=u(i().mark((function e(){var t,r,n,a,o,s=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(t=s.length>0&&void 0!==s[0]?s[0]:{}).width,n=void 0===r?1100:r,a=t.height,o=void 0===a?700:a,e.prev=1,e.abrupt("return",Ie({width:n,height:o}));case 5:return e.prev=5,e.t0=e.catch(1),U("Error opening user management page:".concat(e.t0.name," ").concat(e.t0.message),"openUserManagementPage",{width:n,height:o}).then().catch((function(e){})),e.abrupt("return","failed");case 10:case"end":return e.stop()}}),e,null,[[1,5]])}))),Ee.apply(this,arguments)}function Ie(e){return Se.apply(this,arguments)}function Se(){return(Se=u(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Oe(j),Je(t),e.next=4,Le();case 4:return r=e.sent,e.next=7,le(r.url,t.width,t.height);case 7:if(!e.sent||"succeed"!==r.api_status){e.next=12;break}return e.abrupt("return","succeed");case 12:return e.abrupt("return","failed");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(){return Te.apply(this,arguments)}function Te(){return(Te=u(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(v,{method:"POST"});case 2:if(t=e.sent,parseInt(t.code)!==m){e.next=7;break}return e.abrupt("return",{api_status:"succeed",url:t.data.url});case 7:if(401!==parseInt(t.code)){e.next=11;break}return e.abrupt("return",{api_status:"expired",url:t.data.url});case 11:throw r="get user management error: ".concat(JSON.stringify(t)),t.code&&t.message&&(r="".concat(t.code,": ").concat(t.message)),new h(r);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(){return(je=u(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t().storage.local.remove([k,O]);case 3:return e.abrupt("return","succeed");case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return","failed");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function Ne(){return Ne=u(i().mark((function e(){var t,r,n,a=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:1100,r=a.length>1&&void 0!==a[1]?a[1]:700,e.prev=2,n={width:t,height:r},e.abrupt("return",Re(n));case 7:return e.prev=7,e.t0=e.catch(2),U(e.t0.message,"open_login_page",{width:t,height:r},"error").then().catch(),e.abrupt("return","failed");case 12:case"end":return e.stop()}}),e,null,[[2,7]])}))),Ne.apply(this,arguments)}function Ce(){return Ce=u(i().mark((function e(){var t,r,n,a,o,s=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(t=s.length>0&&void 0!==s[0]?s[0]:{}).width,n=void 0===r?1100:r,a=t.height,o=void 0===a?700:a,e.prev=1,e.abrupt("return",Re({width:n,height:o}));case 5:return e.prev=5,e.t0=e.catch(1),U(e.t0.message,"openLoginPage",{width:n,height:o},"error").then().catch(),e.abrupt("return","failed");case 10:case"end":return e.stop()}}),e,null,[[1,5]])}))),Ce.apply(this,arguments)}function Re(e){return Me.apply(this,arguments)}function Me(){return(Me=u(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.width,n=t.height,Oe(N),Je({width:r,height:n}),e.next=5,M();case 5:return a=e.sent,e.next=8,le(a.url,r,n);case 8:if(!e.sent||"succeed"!==a.api_status){e.next=11;break}return e.abrupt("return","succeed");case 11:return e.abrupt("return","failed");case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(){return Fe=u(i().mark((function e(t){var r,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={plan_id:t,currency:n.length>1&&void 0!==n[1]?n[1]:"",redirect_url:n.length>2&&void 0!==n[2]?n[2]:"",origial_data:n.length>3&&void 0!==n[3]?n[3]:null,width:n.length>4&&void 0!==n[4]?n[4]:1100,height:n.length>5&&void 0!==n[5]?n[5]:700},e.prev=6,e.abrupt("return",Ue(r));case 10:return e.prev=10,e.t0=e.catch(6),U("Opening payment page failed","open_payment_choose_page",r,"error").then().catch(),e.abrupt("return","failed");case 15:case"end":return e.stop()}}),e,null,[[6,10]])}))),Fe.apply(this,arguments)}function Ue(e){return De.apply(this,arguments)}function De(){return(De=u(i().mark((function e(t){var r,n,a,o,s,c,u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.plan_id,n=t.currency,a=t.redirect_url,o=t.origial_data,s=t.width,c=t.height,Oe(R),Je({plan_id:r,currency:n,redirect_url:a,origial_data:o,width:s,height:c},{plan_id:!0,currency:!0}),e.next=5,$e(r,n.toLowerCase(),a,o);case 5:return u=e.sent,e.next=8,le(u.data.url,s,c);case 8:if(l=e.sent,"succeed"!==u.api_status||!l){e.next=11;break}return e.abrupt("return","succeed");case 11:return e.abrupt("return","failed");case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(){return(Ge=u(i().mark((function e(t){var r,n,a,o,s,c,u,l,p,g;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.plan_id,n=t.currency,a=t.redirect_url,o=void 0===a?"":a,s=t.origial_data,c=void 0===s?null:s,u=t.width,l=void 0===u?1100:u,p=t.height,g=void 0===p?700:p,e.prev=1,e.abrupt("return",Ue({plan_id:r,currency:n,redirect_url:o,origial_data:c,width:l,height:g}));case 5:return e.prev=5,e.t0=e.catch(1),U("Failed to open the payment page","openPaymentChoosePage",{plan_id:r,currency:n,redirect_url:o,origial_data:c,width:l,height:g},"error").then(),e.abrupt("return","failed");case 10:case"end":return e.stop()}}),e,null,[[1,5]])})))).apply(this,arguments)}function Je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(ce(n)||ce(a))throw new h("Please check application_id and client_id");for(var r in t)if(t[r]&&(!e.hasOwnProperty(r)||null===e[r]||void 0===e[r]||""===String(e[r]).trim()))throw new h("".concat(r," is a required parameter"));if(e.plan_id&&"string"!=typeof e.plan_id)throw new h("plan_id must be a string");if(e.redirect_url&&""!==e.redirect_url&&!function(e){try{return new URL(e),!0}catch(e){return!1}}(e.redirect_url))throw new h("redirect_url must be a valid web URL");if(e.origial_data&&!B(e.origial_data))throw new h("origial_data must be a JSON object");if(e.width&&isNaN(e.width))throw new h("width must be a number");if(e.height&&isNaN(e.height))throw new h("height must be a number");if(e.user_key&&("string"!=typeof e.user_key||""===e.user_key.trim()))throw new h("user_key must be a non-empty string")}function $e(e){return qe.apply(this,arguments)}function qe(){return qe=u(i().mark((function e(t){var r,n,a,o,s,c=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>3&&void 0!==c[3]?c[3]:null,a={price_id:t,currency:c.length>1&&void 0!==c[1]?c[1]:""},(r=c.length>2&&void 0!==c[2]?c[2]:"")&&(a.redirect_url=r),!n){e.next=12;break}if(!B(n)){e.next=11;break}a.origin_data=n,a.quantity=n.quantity||1,e.next=12;break;case 11:throw new h("origial_data is not a JSON object");case 12:return e.next=14,K(P,{method:"POST",body:JSON.stringify(a)});case 14:if(o=e.sent,parseInt(o.code)!==m){e.next=19;break}return e.abrupt("return",{data:o.data,api_status:"succeed"});case 19:if(401!==parseInt(o.code)){e.next=23;break}return e.abrupt("return",{data:o.data,api_status:"expired"});case 23:throw s="get payment choose url error: ".concat(JSON.stringify(o)),o.code&&o.message&&(s="".concat(o.code,": ").concat(o.message)),new h(s);case 26:case"end":return e.stop()}}),e)}))),qe.apply(this,arguments)}function Be(){return(Be=u(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,oe();case 3:if(t=e.sent,parseInt(t.code)!==m){e.next=6;break}return e.abrupt("return",Ye(t.payinfo));case 6:return e.abrupt("return",t);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function Ke(){return(Ke=u(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,oe();case 4:if(t=e.sent,parseInt(t.code)!==m){e.next=7;break}return e.abrupt("return",Ye(t.payinfo));case 7:return e.abrupt("return",t);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function Ye(e){if(Array.isArray(e)&&e.length>0){var t=["created","updated"],r=["canceling","canceled"];return e.filter((function(e){if("one_time"===e.plan_type&&"succeed"===e.pay_status)return e;if("recurring"===e.plan_type){if(t.includes(e.order_status))return e;if(r.includes(e.order_status)&&e.plan_end>Date.now()/1e3)return e}}))}return[]}function We(){return(We=u(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={user_key:t},e.prev=1,e.abrupt("return",ze(r));case 5:e.prev=5,e.t0=e.catch(1),U("Failed register loginInformation:","register_login_information",r,"error").then().catch();case 8:case"end":return e.stop()}}),e,null,[[1,5]])})))).apply(this,arguments)}function ze(e){return Ve.apply(this,arguments)}function Ve(){return(Ve=u(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.user_key,Je(t,{user_key:!0}),e.next=4,K(b,{method:"POST",body:JSON.stringify({user_key:r})});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ze(e){return He.apply(this,arguments)}function He(){return(He=u(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",ze(t));case 4:e.prev=4,e.t0=e.catch(0),U("Failed register loginInformation:".concat(e.t0.name,",").concat(e.t0.message),Ze,t).then().catch();case 8:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}return t().windows.onRemoved.addListener((function(e){ue=ue.filter((function(t){return t.id!==e}))})),{get_user_info:function(){return ne.apply(this,arguments)},get_valid_subscriptions:function(){return Be.apply(this,arguments)},open_login_page:function(){return Ne.apply(this,arguments)},open_user_management_page:function(){return Pe.apply(this,arguments)},open_payment_page:function(e){return ye.apply(this,arguments)},open_payment_choose_page:function(e){return Fe.apply(this,arguments)},register_login_information:function(e){return We.apply(this,arguments)},on_pay_completed:{addListener:function(e){I.push(e),he()}},on_login_completed:{addListener:function(e){S.push(e),he()}},getUserInfo:oe,getValidSubscriptions:function(){return Ke.apply(this,arguments)},openLoginPage:function(){return Ce.apply(this,arguments)},openUserManagementPage:function(){return Ee.apply(this,arguments)},openPaymentPage:function(e){return ve.apply(this,arguments)},openPaymentChoosePage:function(e){return Ge.apply(this,arguments)},registerLoginInformation:Ze,doLogout:function(){return je.apply(this,arguments)},openPaymentPageNew:function(e){return Ae.apply(this,arguments)},onPayCompleted:{addListener:function(e){I.push(e),he()}},onLoginCompleted:{addListener:function(e){S.push(e),he()}}}}({application_id:"e9161c18-ffae-11ee-898e-ce79243760f4",client_id:"c276836a-27ca-11ef-8b6b-a6ae4ae936bc",mode:"production"});A.onPayCompleted.addListener(((e,t)=>{v()})),A.onLoginCompleted.addListener((e=>{v()})),chrome.runtime.onMessage.addListener(((e,t,r)=>("BACKGROUND"==e.target&&("OPEN PAYMENT PAGE"==e.type?(A.openPaymentChoosePage({plan_id:e.price_id,currency:"usd"}),r({status:"success"})):"OPEN LOGIN PAGE"==e.type&&(A.openLoginPage(),r({status:"success"}))),!0))),chrome.runtime.onInstalled.addListener((function(e){"install"===e.reason&&chrome.tabs.create({url:"https://www.bandlab.com/feed/trending"})})),chrome.runtime.setUninstallURL("https://docs.google.com/forms/d/e/1FAIpQLScyr11IFGjzLmOq-CT54Ky0Rgz0dPf2Xho66n_zivqAbFuh1A/viewform?usp=sf_link"),v()})()})();